<!DOCTYPE html><html lang="en"><head><title>collections/slides</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="collections/slides"><meta name="groc-project-path" content="js/collections/slides.js"><meta name="groc-github-url" content="https://github.com/kkemple/talks.browserify-marionette"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/kkemple/talks.browserify-marionette/blob/master/js/collections/slides.js">js/collections/slides.js</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-pi">'use strict'</span>;

<span class="hljs-keyword">var</span> Slide = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../models/slide'</span>),
    Backbone = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../libs/backbone'</span>),
    commands = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../config/commands'</span>),
    Slides;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The collection that is home to all slides in the app</p></div></div><div class="code"><div class="wrapper">Slides = Backbone.Collection.extend({
    model: Slide,
    initialize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(models)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>if we have any models set the first one to active (could be option)</p></div></div><div class="code"><div class="wrapper">        <span class="hljs-keyword">if</span> (models &amp;&amp; models.length) {
            models[<span class="hljs-number">0</span>].active = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">this</span>.index = <span class="hljs-number">0</span>;
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Responsible for transitioning to the next step/slide
Checks the current slide (model) to see if it has steps and can step forward
if it can not, it checks the collection itself</p></div></div><div class="code"><div class="wrapper">    stepForward: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
        <span class="hljs-keyword">var</span> slide;

        slide = <span class="hljs-keyword">this</span>.current;
        <span class="hljs-keyword">if</span> (slide &amp;&amp; slide.canStepForward()) {
            slide.stepForward();
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.index === <span class="hljs-keyword">this</span>.length - <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.setActiveSlide(++<span class="hljs-keyword">this</span>.index);
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Responsible for transitioning to the previous step/slide
Checks the current slide to see if it has steps and can step bacward
if it can not, it checks the collection itself</p></div></div><div class="code"><div class="wrapper">    stepBackward: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
        <span class="hljs-keyword">var</span> slide;

        slide = <span class="hljs-keyword">this</span>.current;
        <span class="hljs-keyword">if</span> (slide &amp;&amp; slide.canStepBackward()) {
            slide.stepBackward();
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.index === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.setActiveSlide(--<span class="hljs-keyword">this</span>.index);
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Responsible for transitioning to the specified slide</p></div></div><div class="code"><div class="wrapper">    stepTo: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(index)</span> {</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> index !== <span class="hljs-string">'number'</span> ||
                index &gt; <span class="hljs-keyword">this</span>.length ||
                index &lt; <span class="hljs-number">1</span>) {

            commands.execute(<span class="hljs-string">'app:navigate'</span>, <span class="hljs-string">'slides/'</span> + (<span class="hljs-keyword">this</span>.index + <span class="hljs-number">1</span>));
            <span class="hljs-keyword">return</span>;
        }
        --index;
        <span class="hljs-keyword">if</span> (index === <span class="hljs-keyword">this</span>.index) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">this</span>.index = index;
        <span class="hljs-keyword">this</span>.setActiveSlide(<span class="hljs-keyword">this</span>.index);
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Responsible for setting the active slide and then
firing related app events</p></div></div><div class="code"><div class="wrapper">    setActiveSlide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(index)</span> {</span>
        <span class="hljs-keyword">this</span>.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(m)</span> {</span> m.set(<span class="hljs-string">'active'</span>, <span class="hljs-literal">false</span>); });
        <span class="hljs-keyword">this</span>.current = <span class="hljs-keyword">this</span>.at(index);
        <span class="hljs-keyword">this</span>.current.set(<span class="hljs-string">'active'</span>, <span class="hljs-literal">true</span>);
        commands.execute(<span class="hljs-string">'app:navigate'</span>, <span class="hljs-string">'slides/'</span> + (<span class="hljs-keyword">this</span>.index + <span class="hljs-number">1</span>));
        commands.execute(<span class="hljs-string">'app:title'</span>, <span class="hljs-keyword">this</span>.current.get(<span class="hljs-string">'title'</span>));
    }
});

module.exports = Slides;</div></div></div></div></body></html>